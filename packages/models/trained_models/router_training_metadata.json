{
  "family": "router",
  "trained_at_utc": "2026-02-28T16:24:26.694005+00:00",
  "rows": {
    "train": 8422,
    "test": 1050,
    "eval": 1064
  },
  "tasks": [
    "confidence_bin",
    "constraint_dimension",
    "context_tag",
    "decay_profile",
    "importance_bin",
    "memory_type",
    "query_domain",
    "query_intent",
    "salience_bin"
  ],
  "task_label_counts": {
    "train": {
      "confidence_bin": {
        "high": 82,
        "low": 80,
        "medium": 80
      },
      "constraint_dimension": {
        "causal": 80,
        "goal": 80,
        "other": 80,
        "policy": 80,
        "state": 80,
        "value": 80
      },
      "context_tag": {
        "finance": 80,
        "food": 80,
        "general": 80,
        "health": 80,
        "social": 80,
        "tech": 81,
        "travel": 80,
        "work": 80
      },
      "decay_profile": {
        "fast": 80,
        "medium": 80,
        "slow": 80,
        "very_fast": 80,
        "very_slow": 80
      },
      "importance_bin": {
        "high": 80,
        "low": 80,
        "medium": 80
      },
      "memory_type": {
        "constraint": 80,
        "conversation": 80,
        "episodic_event": 80,
        "hypothesis": 80,
        "knowledge": 80,
        "message": 80,
        "observation": 81,
        "plan": 82,
        "preference": 87,
        "procedure": 80,
        "reasoning_step": 81,
        "scratch": 80,
        "semantic_fact": 80,
        "task_state": 80,
        "tool_result": 84
      },
      "query_domain": {
        "finance": 4000,
        "food": 80,
        "general": 80,
        "health": 80,
        "social": 80,
        "tech": 80,
        "travel": 80,
        "work": 82
      },
      "query_intent": {
        "constraint_check": 80,
        "conversation": 80,
        "factual": 80,
        "planning": 80,
        "tool_query": 80
      },
      "salience_bin": {
        "high": 81,
        "low": 80,
        "medium": 81
      }
    },
    "test": {
      "confidence_bin": {
        "high": 10,
        "low": 10,
        "medium": 10
      },
      "constraint_dimension": {
        "causal": 10,
        "goal": 10,
        "other": 10,
        "policy": 10,
        "state": 10,
        "value": 10
      },
      "context_tag": {
        "finance": 10,
        "food": 10,
        "general": 10,
        "health": 10,
        "social": 10,
        "tech": 10,
        "travel": 10,
        "work": 10
      },
      "decay_profile": {
        "fast": 10,
        "medium": 10,
        "slow": 10,
        "very_fast": 10,
        "very_slow": 10
      },
      "importance_bin": {
        "high": 10,
        "low": 10,
        "medium": 10
      },
      "memory_type": {
        "constraint": 10,
        "conversation": 10,
        "episodic_event": 10,
        "hypothesis": 10,
        "knowledge": 10,
        "message": 10,
        "observation": 10,
        "plan": 10,
        "preference": 10,
        "procedure": 10,
        "reasoning_step": 10,
        "scratch": 10,
        "semantic_fact": 10,
        "task_state": 10,
        "tool_result": 10
      },
      "query_domain": {
        "finance": 500,
        "food": 10,
        "general": 10,
        "health": 10,
        "social": 10,
        "tech": 10,
        "travel": 10,
        "work": 10
      },
      "query_intent": {
        "constraint_check": 10,
        "conversation": 10,
        "factual": 10,
        "planning": 10,
        "tool_query": 10
      },
      "salience_bin": {
        "high": 10,
        "low": 10,
        "medium": 10
      }
    },
    "eval": {
      "confidence_bin": {
        "high": 11,
        "low": 10,
        "medium": 10
      },
      "constraint_dimension": {
        "causal": 10,
        "goal": 11,
        "other": 10,
        "policy": 10,
        "state": 10,
        "value": 10
      },
      "context_tag": {
        "finance": 10,
        "food": 10,
        "general": 10,
        "health": 10,
        "social": 10,
        "tech": 11,
        "travel": 10,
        "work": 10
      },
      "decay_profile": {
        "fast": 10,
        "medium": 10,
        "slow": 10,
        "very_fast": 10,
        "very_slow": 10
      },
      "importance_bin": {
        "high": 10,
        "low": 10,
        "medium": 10
      },
      "memory_type": {
        "constraint": 10,
        "conversation": 10,
        "episodic_event": 10,
        "hypothesis": 10,
        "knowledge": 10,
        "message": 11,
        "observation": 11,
        "plan": 11,
        "preference": 12,
        "procedure": 10,
        "reasoning_step": 11,
        "scratch": 10,
        "semantic_fact": 10,
        "task_state": 10,
        "tool_result": 11
      },
      "query_domain": {
        "finance": 500,
        "food": 10,
        "general": 10,
        "health": 10,
        "social": 10,
        "tech": 10,
        "travel": 10,
        "work": 11
      },
      "query_intent": {
        "constraint_check": 11,
        "conversation": 10,
        "factual": 10,
        "planning": 10,
        "tool_query": 10
      },
      "salience_bin": {
        "high": 11,
        "low": 10,
        "medium": 11
      }
    }
  },
  "labels": [
    "confidence_bin::high",
    "confidence_bin::low",
    "confidence_bin::medium",
    "constraint_dimension::causal",
    "constraint_dimension::goal",
    "constraint_dimension::other",
    "constraint_dimension::policy",
    "constraint_dimension::state",
    "constraint_dimension::value",
    "context_tag::finance",
    "context_tag::food",
    "context_tag::general",
    "context_tag::health",
    "context_tag::social",
    "context_tag::tech",
    "context_tag::travel",
    "context_tag::work",
    "decay_profile::fast",
    "decay_profile::medium",
    "decay_profile::slow",
    "decay_profile::very_fast",
    "decay_profile::very_slow",
    "importance_bin::high",
    "importance_bin::low",
    "importance_bin::medium",
    "memory_type::constraint",
    "memory_type::conversation",
    "memory_type::episodic_event",
    "memory_type::hypothesis",
    "memory_type::knowledge",
    "memory_type::message",
    "memory_type::observation",
    "memory_type::plan",
    "memory_type::preference",
    "memory_type::procedure",
    "memory_type::reasoning_step",
    "memory_type::scratch",
    "memory_type::semantic_fact",
    "memory_type::task_state",
    "memory_type::tool_result",
    "query_domain::finance",
    "query_domain::food",
    "query_domain::general",
    "query_domain::health",
    "query_domain::social",
    "query_domain::tech",
    "query_domain::travel",
    "query_domain::work",
    "query_intent::constraint_check",
    "query_intent::conversation",
    "query_intent::factual",
    "query_intent::planning",
    "query_intent::tool_query",
    "salience_bin::high",
    "salience_bin::low",
    "salience_bin::medium"
  ],
  "label_to_id": {
    "confidence_bin::high": 0,
    "confidence_bin::low": 1,
    "confidence_bin::medium": 2,
    "constraint_dimension::causal": 3,
    "constraint_dimension::goal": 4,
    "constraint_dimension::other": 5,
    "constraint_dimension::policy": 6,
    "constraint_dimension::state": 7,
    "constraint_dimension::value": 8,
    "context_tag::finance": 9,
    "context_tag::food": 10,
    "context_tag::general": 11,
    "context_tag::health": 12,
    "context_tag::social": 13,
    "context_tag::tech": 14,
    "context_tag::travel": 15,
    "context_tag::work": 16,
    "decay_profile::fast": 17,
    "decay_profile::medium": 18,
    "decay_profile::slow": 19,
    "decay_profile::very_fast": 20,
    "decay_profile::very_slow": 21,
    "importance_bin::high": 22,
    "importance_bin::low": 23,
    "importance_bin::medium": 24,
    "memory_type::constraint": 25,
    "memory_type::conversation": 26,
    "memory_type::episodic_event": 27,
    "memory_type::hypothesis": 28,
    "memory_type::knowledge": 29,
    "memory_type::message": 30,
    "memory_type::observation": 31,
    "memory_type::plan": 32,
    "memory_type::preference": 33,
    "memory_type::procedure": 34,
    "memory_type::reasoning_step": 35,
    "memory_type::scratch": 36,
    "memory_type::semantic_fact": 37,
    "memory_type::task_state": 38,
    "memory_type::tool_result": 39,
    "query_domain::finance": 40,
    "query_domain::food": 41,
    "query_domain::general": 42,
    "query_domain::health": 43,
    "query_domain::social": 44,
    "query_domain::tech": 45,
    "query_domain::travel": 46,
    "query_domain::work": 47,
    "query_intent::constraint_check": 48,
    "query_intent::conversation": 49,
    "query_intent::factual": 50,
    "query_intent::planning": 51,
    "query_intent::tool_query": 52,
    "salience_bin::high": 53,
    "salience_bin::low": 54,
    "salience_bin::medium": 55
  },
  "train_config": {
    "max_features": 250000,
    "min_df": 1,
    "ngram_min": 1,
    "ngram_max": 3,
    "max_iter": 35,
    "alpha": 1e-05,
    "seed": 42,
    "predict_batch_size": 8192,
    "use_char_ngrams": true,
    "char_ngram_min": 3,
    "char_ngram_max": 5,
    "char_min_df": 2,
    "char_max_features": 250000,
    "sgd_average": true,
    "use_early_stopping": true,
    "early_stopping_metric": "eval_focus_macro_f1",
    "early_stopping_patience": 7,
    "early_stopping_min_delta": 0.0001,
    "task_weight_power": 0.6,
    "label_weight_power": 0.08,
    "sample_weight_min": 0.2,
    "sample_weight_max": 5.0,
    "task_focus_weights": {
      "memory_type": 2.0
    },
    "focus_task_weights": {
      "memory_type": 1.0
    }
  },
  "epoch_stats": [
    {
      "epoch": 1,
      "train_loss": 0.19530908724973886,
      "train_accuracy": 0.9701971028259321,
      "train_macro_f1": 0.9532645774416323,
      "train_weighted_f1": 0.9704063631060345,
      "eval_accuracy": 0.8261278195488722,
      "eval_macro_f1": 0.6914429513971128,
      "eval_task_macro_f1": 0.7482047743909948,
      "eval_focus_macro_f1": 0.6672429938905912,
      "selection_metric": 0.6672429938905912
    },
    {
      "epoch": 2,
      "train_loss": 0.11333555144860366,
      "train_accuracy": 0.992519591545951,
      "train_macro_f1": 0.988770696772763,
      "train_weighted_f1": 0.9925399371819338,
      "eval_accuracy": 0.856203007518797,
      "eval_macro_f1": 0.7413919701395321,
      "eval_task_macro_f1": 0.7922841896823631,
      "eval_focus_macro_f1": 0.6946026167388395,
      "selection_metric": 0.6946026167388395
    },
    {
      "epoch": 3,
      "train_loss": 0.11101048903510233,
      "train_accuracy": 0.9976252671574448,
      "train_macro_f1": 0.9961976940462431,
      "train_weighted_f1": 0.9976213163442276,
      "eval_accuracy": 0.8787593984962406,
      "eval_macro_f1": 0.7794165748485061,
      "eval_task_macro_f1": 0.8048783546903971,
      "eval_focus_macro_f1": 0.7441168137735644,
      "selection_metric": 0.7441168137735644
    },
    {
      "epoch": 4,
      "train_loss": 0.12686686675533043,
      "train_accuracy": 0.9985751602944669,
      "train_macro_f1": 0.9977573224796176,
      "train_weighted_f1": 0.9985735684550657,
      "eval_accuracy": 0.8890977443609023,
      "eval_macro_f1": 0.7964934481957063,
      "eval_task_macro_f1": 0.8135238798301256,
      "eval_focus_macro_f1": 0.7614590172942576,
      "selection_metric": 0.7614590172942576
    },
    {
      "epoch": 5,
      "train_loss": 0.13725976932834894,
      "train_accuracy": 0.9986938969365946,
      "train_macro_f1": 0.9978789556077567,
      "train_weighted_f1": 0.998692794287789,
      "eval_accuracy": 0.8862781954887218,
      "eval_macro_f1": 0.794639349226714,
      "eval_task_macro_f1": 0.8108713961543222,
      "eval_focus_macro_f1": 0.737110544192251,
      "selection_metric": 0.737110544192251
    },
    {
      "epoch": 6,
      "train_loss": 0.1411598520201673,
      "train_accuracy": 0.9990501068629779,
      "train_macro_f1": 0.9985471519681115,
      "train_weighted_f1": 0.9990489535360954,
      "eval_accuracy": 0.893796992481203,
      "eval_macro_f1": 0.8071151608250374,
      "eval_task_macro_f1": 0.8243454114029222,
      "eval_focus_macro_f1": 0.7416124183674093,
      "selection_metric": 0.7416124183674093
    },
    {
      "epoch": 7,
      "train_loss": 0.13698244513679877,
      "train_accuracy": 0.9984564236523391,
      "train_macro_f1": 0.9977708845169803,
      "train_weighted_f1": 0.9984577772704032,
      "eval_accuracy": 0.8881578947368421,
      "eval_macro_f1": 0.7984934890581139,
      "eval_task_macro_f1": 0.816262471499152,
      "eval_focus_macro_f1": 0.7265735776315936,
      "selection_metric": 0.7265735776315936
    },
    {
      "epoch": 8,
      "train_loss": 0.13529322633482482,
      "train_accuracy": 0.9991688435051057,
      "train_macro_f1": 0.9987704350461277,
      "train_weighted_f1": 0.9991677547133148,
      "eval_accuracy": 0.8919172932330827,
      "eval_macro_f1": 0.8030136567031765,
      "eval_task_macro_f1": 0.8162186101743052,
      "eval_focus_macro_f1": 0.7535977468586164,
      "selection_metric": 0.7535977468586164
    },
    {
      "epoch": 9,
      "train_loss": 0.13255546439491242,
      "train_accuracy": 0.999525053431489,
      "train_macro_f1": 0.9993258678139895,
      "train_weighted_f1": 0.9995243316985649,
      "eval_accuracy": 0.8919172932330827,
      "eval_macro_f1": 0.8046084812238927,
      "eval_task_macro_f1": 0.8189137342837806,
      "eval_focus_macro_f1": 0.7325948230870382,
      "selection_metric": 0.7325948230870382
    },
    {
      "epoch": 10,
      "train_loss": 0.13291427280483822,
      "train_accuracy": 0.9988126335787224,
      "train_macro_f1": 0.9981007405130303,
      "train_weighted_f1": 0.9988122454626881,
      "eval_accuracy": 0.900375939849624,
      "eval_macro_f1": 0.8202673966067069,
      "eval_task_macro_f1": 0.8324645034474867,
      "eval_focus_macro_f1": 0.7709962693380829,
      "selection_metric": 0.7709962693380829
    },
    {
      "epoch": 11,
      "train_loss": 0.13017523615050813,
      "train_accuracy": 0.9989313702208501,
      "train_macro_f1": 0.9983253569880696,
      "train_weighted_f1": 0.9989316843499085,
      "eval_accuracy": 0.8909774436090225,
      "eval_macro_f1": 0.8041074667559919,
      "eval_task_macro_f1": 0.8182838832775043,
      "eval_focus_macro_f1": 0.7458594026982773,
      "selection_metric": 0.7458594026982773
    },
    {
      "epoch": 12,
      "train_loss": 0.12835521276928089,
      "train_accuracy": 0.9991688435051057,
      "train_macro_f1": 0.9986631217290337,
      "train_weighted_f1": 0.9991688295901119,
      "eval_accuracy": 0.8956766917293233,
      "eval_macro_f1": 0.8128522774701692,
      "eval_task_macro_f1": 0.8292622022478774,
      "eval_focus_macro_f1": 0.7541249016260458,
      "selection_metric": 0.7541249016260458
    },
    {
      "epoch": 13,
      "train_loss": 0.12708478652022653,
      "train_accuracy": 0.9991688435051057,
      "train_macro_f1": 0.9986603241565979,
      "train_weighted_f1": 0.9991681170200263,
      "eval_accuracy": 0.8984962406015038,
      "eval_macro_f1": 0.8169843761010009,
      "eval_task_macro_f1": 0.8297507180530069,
      "eval_focus_macro_f1": 0.7719422882298101,
      "selection_metric": 0.7719422882298101
    },
    {
      "epoch": 14,
      "train_loss": 0.12487918682383461,
      "train_accuracy": 0.9988126335787224,
      "train_macro_f1": 0.9980979582910362,
      "train_weighted_f1": 0.9988107654870846,
      "eval_accuracy": 0.900375939849624,
      "eval_macro_f1": 0.8202720064662049,
      "eval_task_macro_f1": 0.8369460328310141,
      "eval_focus_macro_f1": 0.7609600534787415,
      "selection_metric": 0.7609600534787415
    },
    {
      "epoch": 15,
      "train_loss": 0.12472502899840568,
      "train_accuracy": 0.9990501068629779,
      "train_macro_f1": 0.99854580849632,
      "train_weighted_f1": 0.9990497417088309,
      "eval_accuracy": 0.893796992481203,
      "eval_macro_f1": 0.8066464326063164,
      "eval_task_macro_f1": 0.822336051807333,
      "eval_focus_macro_f1": 0.7424210117816255,
      "selection_metric": 0.7424210117816255
    },
    {
      "epoch": 16,
      "train_loss": 0.12431172655702673,
      "train_accuracy": 0.9983376870102113,
      "train_macro_f1": 0.9973372701304822,
      "train_weighted_f1": 0.9983361654614162,
      "eval_accuracy": 0.8928571428571429,
      "eval_macro_f1": 0.8080479806972324,
      "eval_task_macro_f1": 0.8229457293883441,
      "eval_focus_macro_f1": 0.7453938590437447,
      "selection_metric": 0.7453938590437447
    },
    {
      "epoch": 17,
      "train_loss": 0.1220219781531759,
      "train_accuracy": 0.9990501068629779,
      "train_macro_f1": 0.9985458172159686,
      "train_weighted_f1": 0.999049746347162,
      "eval_accuracy": 0.8947368421052632,
      "eval_macro_f1": 0.8098415412588563,
      "eval_task_macro_f1": 0.8292913411350044,
      "eval_focus_macro_f1": 0.7464463742690728,
      "selection_metric": 0.7464463742690728
    },
    {
      "epoch": 18,
      "train_loss": 0.12097399352141165,
      "train_accuracy": 0.9989313702208501,
      "train_macro_f1": 0.9984367953450828,
      "train_weighted_f1": 0.9989320845818312,
      "eval_accuracy": 0.8928571428571429,
      "eval_macro_f1": 0.8062472836381439,
      "eval_task_macro_f1": 0.8251551991292184,
      "eval_focus_macro_f1": 0.7405389085188969,
      "selection_metric": 0.7405389085188969
    },
    {
      "epoch": 19,
      "train_loss": 0.11951560798887062,
      "train_accuracy": 0.9991688435051057,
      "train_macro_f1": 0.9987690402213316,
      "train_weighted_f1": 0.9991677409142663,
      "eval_accuracy": 0.893796992481203,
      "eval_macro_f1": 0.8078102693470612,
      "eval_task_macro_f1": 0.8302071225767725,
      "eval_focus_macro_f1": 0.7280649186841136,
      "selection_metric": 0.7280649186841136
    },
    {
      "epoch": 20,
      "train_loss": 0.119890176744908,
      "train_accuracy": 0.9986938969365946,
      "train_macro_f1": 0.9978747158411428,
      "train_weighted_f1": 0.9986927169409372,
      "eval_accuracy": 0.8928571428571429,
      "eval_macro_f1": 0.8055601832773469,
      "eval_task_macro_f1": 0.823575966067619,
      "eval_focus_macro_f1": 0.7445983011469617,
      "selection_metric": 0.7445983011469617
    }
  ]
}